<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forum - –ì–ª–∞–≤–Ω–∞—è</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <header>
        <h1><a href='/'>Welcome to Forum</a></h1>
        <nav>
            {{if .UserID}}
                <a href="/create-post">–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</a> |
                <a href="/filter?type=user">–ú–æ–∏ –ø–æ—Å—Ç—ã</a> |
                <a href="/filter?type=liked">–ü–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è</a> |
                <a href="/logout">–í—ã–π—Ç–∏</a>
            {{else}}
                <a href="/register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a> | <a href="/login">–í–æ–π—Ç–∏</a>
            {{end}}
        </nav>
    </header>

    <main>
        <!-- –§–∏–ª—å—Ç—Ä—ã -->
        <div class="filters">
            <h3>–§–∏–ª—å—Ç—Ä—ã:</h3>
            <a href="/" class="filter-btn">–í—Å–µ –ø–æ—Å—Ç—ã</a>
            {{range .Categories}}
                <a href="/filter?type=category&category_id={{.ID}}" class="filter-btn">{{.Name}}</a>
            {{end}}
        </div>

        <!-- –°–ø–∏—Å–æ–∫ –ø–æ—Å—Ç–æ–≤ -->
        <div class="posts">
            {{if .Posts}}
                {{range .Posts}}
                    <article class="post">
                        <h3><a href="/post?id={{.ID}}">{{.Title}}</a></h3>
                        <div class="post-meta">
                            <span class="author">–ê–≤—Ç–æ—Ä: {{.Username}}</span>
                            <span class="date">{{.CreatedAt}}</span>
                        </div>
                        <div class="post-content">
                            {{if gt (len .Content) 200}}
                                {{printf "%.200s" .Content}}...
                            {{else}}
                                {{.Content}}
                            {{end}}
                        </div>
                        <div class="post-stats">
                            <span class="comments">üí¨ {{.CommentCount}}</span>
                            <span class="likes">üëç {{.Likes}}</span>
                            <span class="dislikes">üëé {{.Dislikes}}</span>
                        </div>
                        {{if $.UserID}}
                            <div class="post-actions">
                                <form method="POST" action="/like" style="display: inline;">
                                    <input type="hidden" name="post_id" value="{{.ID}}">
                                    <input type="hidden" name="is_like" value="1">
                                    <button type="submit" class="like-btn">üëç</button>
                                </form>
                                <form method="POST" action="/like" style="display: inline;">
                                    <input type="hidden" name="post_id" value="{{.ID}}">
                                    <input type="hidden" name="is_like" value="0">
                                    <button type="submit" class="dislike-btn">üëé</button>
                                </form>
                            </div>
                        {{end}}
                    </article>
                {{end}}
            {{else}}
                <p>–ü–æ—Å—Ç–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. {{if .UserID}}<a href="/create-post">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π!</a>{{end}}</p>
            {{end}}
        </div>
    </main>

    <footer>Powered by <a href='https://t.me/zz_maga'>Magzhan</a></footer>
</body>
</html>
